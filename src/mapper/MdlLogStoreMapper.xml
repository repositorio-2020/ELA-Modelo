<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
    
<mapper namespace="MdlLogStore">
       
    <resultMap id="result" type="cl.mybatis.pojos.MdlLogStore">    
        <result property="program" column="program"/>
        <result property="id" column="id"/>
        <result property="eventname" column="eventname"/>
        <result property="component" column="component"/>
        <result property="logaction" column="logaction"/>
        <result property="target" column="target"/>
        <result property="objecttable" column="objecttable"/>
        <result property="objectid" column="objectid"/>
        <result property="crud" column="crud"/>
        <result property="edulevel" column="edulevel"/>
        <result property="contextid" column="contextid"/>
        <result property="contextlevel" column="contextlevel"/>
        <result property="contextinstanceid" column="contextinstanceid"/>
        <result property="userid" column="userid"/>
        <result property="courseid" column="courseid"/>
        <result property="relateduserid" column="relateduserid"/>
        <result property="anonymous" column="anonymous"/>
        <result property="other" column="other"/>
        <result property="timecreated" column="timecreated"/>
        <result property="origin" column="origin"/>
        <result property="ip" column="ip"/>
        <result property="realuserid" column="realuserid"/>
    </resultMap>
  
    <select id="selectFilter" parameterType="cl.mybatis.pojos.MdlLogStore" resultMap="result">                       
        SELECT mdl_logstore_standard_log.program,
            mdl_logstore_standard_log.id,
            mdl_logstore_standard_log.eventname,
            mdl_logstore_standard_log.component,
            mdl_logstore_standard_log.Logaction,
            mdl_logstore_standard_log.target,
            mdl_logstore_standard_log.objecttable,
            mdl_logstore_standard_log.objectid,
            mdl_logstore_standard_log.crud,
            mdl_logstore_standard_log.edulevel,
            mdl_logstore_standard_log.contextid,
            mdl_logstore_standard_log.contextlevel,
            mdl_logstore_standard_log.contextinstanceid,
            mdl_logstore_standard_log.userid,
            mdl_logstore_standard_log.courseid,
            mdl_logstore_standard_log.relateduserid,
            mdl_logstore_standard_log.anonymous,
            mdl_logstore_standard_log.other,
            mdl_logstore_standard_log.timecreated,
            mdl_logstore_standard_log.origin,
            mdl_logstore_standard_log.ip,
            mdl_logstore_standard_log.realuserid
        FROM isahc.mdl_logstore_standard_log limit 500;
    </select>
            
    <select id="selectAll" parameterType="cl.mybatis.pojos.MdlLogStore" resultMap="result">               
        SELECT mdl_logstore_standard_log.program,
            mdl_logstore_standard_log.id,
            mdl_logstore_standard_log.eventname,
            mdl_logstore_standard_log.component,
            mdl_logstore_standard_log.logaction,
            mdl_logstore_standard_log.target,
            mdl_logstore_standard_log.objecttable,
            mdl_logstore_standard_log.objectid,
            mdl_logstore_standard_log.crud,
            mdl_logstore_standard_log.edulevel,
            mdl_logstore_standard_log.contextid,
            mdl_logstore_standard_log.contextlevel,
            mdl_logstore_standard_log.contextinstanceid,
            mdl_logstore_standard_log.userid,
            mdl_logstore_standard_log.courseid,
            mdl_logstore_standard_log.relateduserid,
            mdl_logstore_standard_log.anonymous,
            mdl_logstore_standard_log.other,
            mdl_logstore_standard_log.timecreated,
            mdl_logstore_standard_log.origin,
            mdl_logstore_standard_log.ip,
            mdl_logstore_standard_log.realuserid
        FROM isahc.mdl_logstore_standard_log limit 200;
    </select>
       

    <select id="selectParametro" parameterType="cl.mybatis.pojos.MdlLogStore" resultMap="result">               
        SELECT initTablaCargue() id FROM isahc.acc_par_parametros where acc_par_secue = 1;
    </select>


    <select id="selectConect" parameterType="cl.mybatis.pojos.MdlLogStore" resultMap="result">               
        SELECT initConecciones() id FROM isahc.acc_par_parametros where acc_par_secue = 1;
    </select>

    <select id="calculaIndices" parameterType="cl.mybatis.pojos.MdlLogStore" resultMap="result">               
        SELECT calculaIndices() id FROM isahc.acc_par_parametros where acc_par_secue = 1;
    </select>



    <insert id="update" parameterType="cl.mybatis.pojos.MdlLogStore">     
        UPDATE UNI_UNIVERSIDAD SET
            UNI_CODIGO= #{codigo},
            UNI_NOMBRE = #{nombre},
            UNI_ESTADO = #{estado},
            UNI_CODEQUIVA = #{codEquivale}
        WHERE UNI_ID_SECUE = #{id};
   </insert>    
         
     
    <insert id="insert" keyProperty="id_secue"  parameterType="cl.mybatis.pojos.MdlLogStore">
            INSERT INTO mdl_logstore_standard_log
            (program,
            id,
            eventname,
            component,
            logaction,
            target,
            objecttable,
            objectid,
            crud,
            edulevel,
            contextid,
            contextlevel,
            contextinstanceid,
            userid,
            courseid,
            relateduserid,
            anonymous,
            other,
            timecreated,
            origin,
            ip,
            realuserid,
            agno,
            periodo)
            VALUES (
            #{program},   
            #{id},
            #{eventname},
            #{component},
            #{logaction},
            #{target},
            #{objecttable},
            #{objectid},
            #{crud},
            #{edulevel},
            #{contextid},
            #{contextlevel},
            #{contextinstanceid},
            #{userid},
            #{courseid},
            #{relateduserid},
            #{anonymous},
            #{other},
            #{timecreated},
            #{origin},
            #{ip},
            #{realuserid},
            year(timecreated),
            week(timecreated)
            );        
    </insert>
        
     
    <delete id="delete" parameterType="cl.mybatis.pojos.MdlLogStore">
        delete from mdl_logstore_standard_log where id_secue > 1;
    </delete>             
                  


</mapper>
